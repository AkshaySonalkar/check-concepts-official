<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout}">

<head>
	<title>Admin Console</title>
</head>

<body class="d-flex flex-column h-100">
	<div layout:fragment="content">
		<!--<div class="container">
			<div th:if="${message != null}" class="alert alert-info"
				th:utext="${message}">message</div>

			<h1>This is the landing page for the staff</h1>

			<div th:each="dataa : ${data}">
				<p th:utext="${dataa}">Data</p>
			</div>

			<div sec:authorize="hasAuthority('STAFF_PRIVILEGE')">This text
				is only visible to a staff</div>

			<a class="btn btn-default" th:href="@{/changePassword.html}"
				th:utext="#{message.changePassword}">change password</a>

		</div>-->
		<main sec:authorize="hasAuthority('STAFF_PRIVILEGE')">
			<div class="container-fluid px-4">
				<h3 class="mt-4">Dashboard</h3>
				<ol class="breadcrumb mb-4">
					<li class="breadcrumb-item active">Staff Dashboard</li>
				</ol>
				<div class="row">
					<div class="col-xl-3 col-md-6">
						<div class="card bg-success text-white mb-4">
							<div class="card-body">Total Categories</div>
							<div class="card-footer d-flex align-items-center justify-content-between">
								<div class="counter-container">
									<div class="counter" data-target="9000"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-3 col-md-6">
						<div class="card bg-danger text-white mb-4">
							<div class="card-body">Total Sub Categories</div>
							<div class="card-footer d-flex align-items-center justify-content-between">
								<div class="counter-container">
									<div class="counter" data-target="112000"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-3 col-md-6">
						<div class="card bg-primary text-white mb-4">
							<div class="card-body">Total Posts Created</div>
							<div class="card-footer d-flex align-items-center justify-content-between">
								<div class="counter-container">
									<div class="counter" data-target="12000"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-3 col-md-6">
						<div class="card bg-warning text-white mb-4">
							<div class="card-body">Total Posts Published</div>
							<div class="card-footer d-flex align-items-center justify-content-between">
								<div class="counter-container">
									<div class="counter" data-target="10000"></div>
								</div>
							</div>
						</div>
					</div>
					
					<div class="col-xl-3 col-md-6">
						<div class="card bg-info text-white mb-4">
							<div class="card-body">My Total Created Posts</div>
							<div class="card-footer d-flex align-items-center justify-content-between">
								<div class="counter-container">
									<div class="counter" data-target="12000"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xl-3 col-md-6">
						<div class="card bg-dark text-white mb-4">
							<div class="card-body">My Total Published Posts</div>
							<div class="card-footer d-flex align-items-center justify-content-between">
								<div class="counter-container">
									<div class="counter" data-target="10000"></div>
								</div>
							</div>
						</div>
					</div>

				</div>

				<div class="card mb-4">
					<div class="card-header">
						<i class="fas fa-table me-1"></i>
						Preview Posts
					</div>
					<div class="card-body">
						<table class="table table-striped table-bordered" id="postsTable" style="width: 100%;">
							<thead>
								<tr>
									<th scope="col" style="width: 7.5%;">Id</th>
									<th scope="col" style="width: 25%;">Title</th>
									<th scope="col" style="width: 15%;">Sub Category Type</th>
									<th scope="col" style="width: 15%;">Author</th>
									<th scope="col" style="width: 15%;">Tags</th>
									<th scope="col" style="width: 15%;">Creation Date</th>
									<th scope="col" style="width: 7.5%;">Preview</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="user : ${endusers}">
									<td th:text="${user.firstName}"></td>
									<td th:text="${user.lastName}"></td>
									<td th:text="${user.email}" style="word-break: break-word !important;"></td>
									<td th:text="${user.roles.get(0).name}"></td>
									<td><a th:href="@{/admin/edit/{id}(id=${user.id})}" class="btn btn-primary"><i
												class="fas fa-user-edit ml-2"></i></a></td>
									<td><a th:href="@{/admin/deactivate/{id}(id=${user.id})}" class="btn btn-primary"
											th:if="${user.accountActive}"><i class="fas fa-user-slash"></i></a>
										<a th:href="@{/admin/activate/{id}(id=${user.id})}" class="btn btn-primary"
											th:unless="${user.accountActive}"><i class="fas fa-user-check"></i></i></a>
									</td>

								</tr>
							</tbody>
						</table>
					</div>
				</div>

			</div>
		</main>

		<script th:inline="javascript">

			const counters = document.querySelectorAll(".counter");

			counters.forEach((counter) => {
				counter.innerText = "0";
				const updateCounter = () => {
					const target = +counter.getAttribute("data-target");
					const count = +counter.innerText;
					const increment = target / 200;
					if (count < target) {
						counter.innerText = `${Math.ceil(count + increment)}`;
						setTimeout(updateCounter, 1);
					} else counter.innerText = target;
				};
				updateCounter();
			});

		</script>
		<script>
			$(document).ready(function () {
				$('#postsTable').dataTable({
					scrollY: 200,
					scrollX: true,
				});

			});

		</script>
	</div>

</body>

</html>